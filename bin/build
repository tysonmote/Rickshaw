#!/usr/bin/env bash

# Create build directory, if needed.
if [ ! -d "./build" ]; then
  mkdir build
fi

# Compile specs, etc. to cache directory
coffee --compile --output cache .

# Compile / join CoffeeScript
coffee --print --compile \
  ./src/Rickshaw.coffee \
  ./src/Rickshaw.Model.coffee \
  ./src/Rickshaw.Collection.coffee \
  ./src/Rickshaw.Persistence.coffee \
  ./src/Rickshaw.Controllers.coffee \
  > ./build/rickshaw.js

# Full version with dependencies
cat ./build/rickshaw.js ./vendor/mustache.js > ./build/rickshaw.full.js

echo "Rickshaw build successful!"
